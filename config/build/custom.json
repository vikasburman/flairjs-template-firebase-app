{
    "plugins": [
        { "name": "node_modules", "settings": { "cmd": "yarn install --prod" } },
        { "name": "web_modules" },
        { "name": "copy_files" },
        { "name": "minify_files" },
        { "name": "write_flags", "settings": { "defaultFlag": "dev" } }
    ],    
    "build": [
        { "profile": "database" },
        { "profile": "firebase" },
        { "profile": "firestore" },
        { "profile": "functions" },
        { "profile": "hosting_fbsite1" },
        { "profile": "hosting_fbsite2" },
        { "profile": "storage" }
    ],
    "profiles": {
        "database": {
            "root": "database",
            "dest": "/database",
            "plugins": ["copy_files"],
            "copy": [
                "database.rules.json"
            ]
        },          
        "firebase": {
            "root": "firebase",
            "dest": "/",
            "plugins": ["copy_files"],
            "copy": [
                "firebase.json",
                ".firebaserc"
            ]
        },      
        "firestore": {
            "root": "firestore",
            "dest": "/firestore",             
            "plugins": ["copy_files"],
            "copy": [
                "firestore.indexes.json",
                "firestore.rules"
            ]
        }, 
        "functions": {
            "root": "functions",
            "dest": "/functions",
            "omitRoot": true,
            "skipMinify": true,
            "build": [
                "app",
                "shared",
                "fbapp1",
                "fbapp2"
            ],
            "plugins": ["copy_files", "node_modules", "write_flags"],
            "copy": [
                "private",
                "appConfig.json",
                "functions.json",
                "~/node_modules/flairjs-fabric/flair.server/main-firebase.js >> ./main.js"
            ],
            "flags": {
                "dev": {
                    "FLAIR_SYMBOLS": "DEV,DEBUG",
                    "FIREBASE_PROJECT_ID": "flairjs-firebase-app"
                },
                "prod": {
                    "FLAIR_SYMBOLS": "PROD",
                    "FIREBASE_PROJECT_ID": "flairjs-firebase-app"
                }
            }            
        },        
        "hosting_fbsite1": {
            "root": "hosting/fbsite1",
            "dest": "/hosting/fbsite1",
            "omitRoot": true,
            "build": [
                "app",
                "features"
            ],
            "plugins": ["copy_files", "web_modules", "minify_files", "write_flags"],
            "copy": [
                "assets",
                "favicon.png",
                "webConfig.json",
                "~/node_modules/flairjs-fabric/flair.client/index.html >> ./index.html",
                "~/node_modules/flairjs-fabric/flair.client/index.js >> ./index.js"
            ],
            "modules": [
                "flairjs",
                "flairjs-fabric",
                "requirejs",
                "vue/dist"
            ],
            "minify": [
                "modules/requirejs/require.js"
            ],
            "flags": {
                "dev": {
                    "FLAIR_SYMBOLS": "DEV,DEBUG"
                },
                "prod": {
                    "FLAIR_SYMBOLS": "PROD"
                }
            }            
        },
        "hosting_fbsite2": {
            "root": "hosting/fbsite2",
            "dest": "/hosting/fbsite2",
            "omitRoot": true,
            "build": [
                "app",
                "features"
            ],
            "plugins": ["copy_files", "web_modules", "minify_files", "write_flags"],
            "copy": [
                "assets",
                "favicon.png",
                "webConfig.json",
                "~/node_modules/flairjs-fabric/flair.client/index.html >> ./index.html",
                "~/node_modules/flairjs-fabric/flair.client/index.js >> ./index.js"
            ],
            "modules": [
                "flairjs",
                "flairjs-fabric",
                "requirejs",
                "vue/dist"
            ],
            "minify": [
                "modules/requirejs/require.js"
            ],
            "flags": {
                "dev": {
                    "FLAIR_SYMBOLS": "DEV,DEBUG"
                },
                "prod": {
                    "FLAIR_SYMBOLS": "PROD"
                }
            }            
        },     
        "storage": {
            "root": "storage",
            "dest": "/storage",            
            "plugins": ["copy_files"],
            "copy": [
                "storage.rules"
            ]
        }        
    }
}